# 1. MODULE IDENTIFICATION

**Module Name:** Ratings
**Module Number:** 06.3
**Module Type:** Master
**Target File:** HR/06.Performance & Goals/06.3 Ratings.md
**Created Date:** December 29, 2025
**Version:** 1.0
**Author:** HR System Architect

--- END OF SECTION 1 ---

## 2. PURPOSE

### 2.1 Business Purpose
The Ratings module provides a comprehensive system for defining, managing, and standardizing performance rating scales and calibration processes. It enables organizations to establish consistent rating frameworks, ensure fair and objective performance evaluations, facilitate calibration sessions, and maintain rating integrity across the organization while supporting various rating methodologies and compliance requirements.

### 2.2 Business Scope
**In Scope:**
- Rating scale definition and configuration
- Multiple rating scale types (numeric, descriptive, behavioral)
- Rating category and level management
- Calibration session management and moderation
- Rating distribution analysis and monitoring
- Performance level definitions and criteria
- Rating guideline and documentation management
- Rating history and trend analysis
- Calibration committee management
- Rating deviation detection and alerts
- Integration with performance review cycles
- Mobile rating access and calibration
- Rating analytics and reporting
- Compliance monitoring and audit trails
- Multi-dimensional rating frameworks
- Rating weight and importance configuration

**Out of Scope:**
- Performance review execution (handled in Review Cycle module)
- Goal setting and tracking (handled in Goal Setting module)
- Compensation planning and bonus calculations
- Advanced talent analytics and succession planning

### 2.3 Key Stakeholders
- **HR Department:** Rating framework design and administration
- **Managers:** Rating application and calibration participation
- **Leadership:** Rating oversight and decision making
- **Calibration Committees:** Rating moderation and standardization
- **Employees:** Rating understanding and feedback reception
- **Compliance Officers:** Rating fairness and audit compliance

--- END OF SECTION 2 ---

## 3. CORE MODELS (DJANGO)

### 3.1 Primary Model: RatingScale

```python
class RatingScale(models.Model):
    """
    Main rating scale model for performance management
    """
    
    # Primary Key
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    
    # Foreign Keys
    company_id = models.UUIDField()
    created_by_user_id = models.UUIDField()
    updated_by_user_id = models.UUIDField()
    
    # Scale Details
    scale_name = models.CharField(max_length=200)
    scale_code = models.CharField(max_length=50)
    scale_type = models.CharField(max_length=50, choices=[
        ('numeric', 'Numeric Scale'),
        ('descriptive', 'Descriptive Scale'),
        ('behavioral', 'Behavioral Scale'),
        ('competency', 'Competency Scale'),
        ('hybrid', 'Hybrid Scale'),
        ('custom', 'Custom Scale'),
    ])
    
    # Scale Configuration
    description = models.TextField(blank=True)
    min_rating = models.DecimalField(max_digits=5, decimal_places=2)
    max_rating = models.DecimalField(max_digits=5, decimal_places=2)
    rating_increment = models.DecimalField(max_digits=5, decimal_places=2)
    
    # Scale Settings
    allow_decimal_ratings = models.BooleanField(default=False)
    decimal_places = models.IntegerField(default=0)
    reverse_rating_order = models.BooleanField(default=False)
    
    # Status and Applicability
    status = models.CharField(max_length=20, choices=[
        ('draft', 'Draft'),
        ('active', 'Active'),
        ('inactive', 'Inactive'),
        ('deprecated', 'Deprecated'),
    ], default='draft')
    
    is_default = models.BooleanField(default=False)
    applies_to_departments = models.JSONField(default=list, blank=True)
    applies_to_roles = models.JSONField(default=list, blank=True)
    applies_to_levels = models.JSONField(default=list, blank=True)
    
    # Effective Dates
    effective_date = models.DateField()
    expiry_date = models.DateField(null=True, blank=True)
    
    # Guidelines and Documentation
    rating_guidelines = models.TextField(blank=True)
    calibration_guidelines = models.TextField(blank=True)
    documentation_url = models.URLField(blank=True)
    
    # Audit Fields
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'hr_rating_scales'
        verbose_name = 'Rating Scale'
        verbose_name_plural = 'Rating Scales'
        indexes = [
            models.Index(fields=['company_id', 'status'], name='idx_scale_status'),
            models.Index(fields=['company_id', 'scale_type'], name='idx_scale_type'),
        ]
        constraints = [
            models.UniqueConstraint(fields=['company_id', 'scale_code'], name='uk_scale_code'),
        ]
```

### 3.2 Supporting Model: RatingLevel

```python
class RatingLevel(models.Model):
    """
    Individual rating levels within a rating scale
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_id = models.UUIDField()
    rating_scale_id = models.UUIDField()
    
    # Level Details
    level_number = models.IntegerField()
    level_name = models.CharField(max_length=200)
    level_code = models.CharField(max_length=50)
    level_description = models.TextField(blank=True)
    
    # Rating Values
    numeric_value = models.DecimalField(max_digits=5, decimal_places=2)
    numeric_range_min = models.DecimalField(max_digits=5, decimal_places=2, null=True, blank=True)
    numeric_range_max = models.DecimalField(max_digits=5, decimal_places=2, null=True, blank=True)
    
    # Performance Classification
    performance_level = models.CharField(max_length=50, choices=[
        ('outstanding', 'Outstanding'),
        ('exceeds_expectations', 'Exceeds Expectations'),
        ('meets_expectations', 'Meets Expectations'),
        ('needs_improvement', 'Needs Improvement'),
        ('unsatisfactory', 'Unsatisfactory'),
        ('custom', 'Custom'),
    ])
    
    # Color and Visual Indicators
    color_code = models.CharField(max_length=20, blank=True)
    icon_name = models.CharField(max_length=100, blank=True)
    
    # Behavioral Indicators
    behavioral_indicators = models.JSONField(default=list, blank=True)
    key_behaviors = models.JSONField(default=list, blank=True)
    development_suggestions = models.JSONField(default=list, blank=True)
    
    # Calibration Guidelines
    calibration_notes = models.TextField(blank=True)
    target_distribution = models.DecimalField(max_digits=5, decimal_places=2, null=True, blank=True)
    
    # Status
    is_active = models.BooleanField(default=True)
    
    # Audit Fields
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'hr_rating_levels'
        verbose_name = 'Rating Level'
        verbose_name_plural = 'Rating Levels'
        indexes = [
            models.Index(fields=['company_id', 'rating_scale_id'], name='idx_level_scale'),
            models.Index(fields=['company_id', 'level_number'], name='idx_level_number'),
        ]
        constraints = [
            models.UniqueConstraint(fields=['company_id', 'rating_scale_id', 'level_code'], name='uk_level_code'),
        ]
```

### 3.3 Supporting Model: CalibrationSession

```python
class CalibrationSession(models.Model):
    """
    Calibration session for rating moderation and standardization
    """
    
    # Primary Key
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    
    # Foreign Keys
    company_id = models.UUIDField()
    review_cycle_id = models.UUIDField()
    rating_scale_id = models.UUIDField()
    created_by_user_id = models.UUIDField()
    updated_by_user_id = models.UUIDField()
    
    # Session Details
    session_name = models.CharField(max_length=200)
    session_code = models.CharField(max_length=50)
    session_type = models.CharField(max_length=50, choices=[
        ('department', 'Department Calibration'),
        ('division', 'Division Calibration'),
        ('organization', 'Organization Calibration'),
        ('level', 'Level Calibration'),
        ('custom', 'Custom Calibration'),
    ])
    
    # Session Configuration
    description = models.TextField(blank=True)
    objectives = models.TextField(blank=True)
    
    # Scheduling
    scheduled_date = models.DateTimeField()
    duration_hours = models.IntegerField(default=2)
    location = models.CharField(max_length=200, blank=True)
    is_virtual = models.BooleanField(default=False)
    meeting_url = models.URLField(blank=True)
    
    # Participants
    facilitator_id = models.UUIDField()
    participants = models.JSONField(default=list, blank=True)
    required_attendees = models.JSONField(default=list, blank=True)
    
    # Status Management
    status = models.CharField(max_length=20, choices=[
        ('planned', 'Planned'),
        ('in_progress', 'In Progress'),
        ('completed', 'Completed'),
        ('cancelled', 'Cancelled'),
        ('postponed', 'Postponed'),
    ], default='planned')
    
    # Calibration Settings
    target_distribution = models.JSONField(default=dict, blank=True)
    tolerance_percentage = models.DecimalField(max_digits=5, decimal_places=2, default=5.0)
    require_justification = models.BooleanField(default=True)
    
    # Results
    total_reviews_calibrated = models.IntegerField(default=0)
    ratings_adjusted = models.IntegerField(default=0)
    average_rating_change = models.DecimalField(max_digits=5, decimal_places=2, default=0)
    
    # Notes and Outcomes
    session_notes = models.TextField(blank=True)
    action_items = models.JSONField(default=list, blank=True)
    follow_up_required = models.BooleanField(default=False)
    
    # Audit Fields
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'hr_calibration_sessions'
        verbose_name = 'Calibration Session'
        verbose_name_plural = 'Calibration Sessions'
        indexes = [
            models.Index(fields=['company_id', 'review_cycle_id'], name='idx_session_cycle'),
            models.Index(fields=['company_id', 'status'], name='idx_session_status'),
            models.Index(fields=['company_id', 'scheduled_date'], name='idx_session_date'),
        ]
        constraints = [
            models.UniqueConstraint(fields=['company_id', 'session_code'], name='uk_session_code'),
        ]
```

--- END OF SECTION 3 ---

## 4. REFERENCE MODELS (DJANGO)

### 4.1 RatingDistribution

```python
class RatingDistribution(models.Model):
    """
    Rating distribution analysis and monitoring
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_id = models.UUIDField()
    review_cycle_id = models.UUIDField()
    rating_scale_id = models.UUIDField()
    
    rating_level_id = models.UUIDField()
    actual_count = models.IntegerField(default=0)
    expected_count = models.IntegerField(default=0)
    actual_percentage = models.DecimalField(max_digits=5, decimal_places=2, default=0)
    expected_percentage = models.DecimalField(max_digits=5, decimal_places=2, default=0)
    
    created_at = models.DateTimeField(auto_now_add=True)
    
    class Meta:
        db_table = 'hr_rating_distributions'
        verbose_name = 'Rating Distribution'
        verbose_name_plural = 'Rating Distributions'
```

### 4.2 RatingGuideline

```python
class RatingGuideline(models.Model):
    """
    Rating guidelines and documentation
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_id = models.UUIDField()
    rating_scale_id = models.UUIDField()
    
    guideline_title = models.CharField(max_length=200)
    guideline_content = models.TextField()
    guideline_type = models.CharField(max_length=50)
    is_active = models.BooleanField(default=True)
    
    class Meta:
        db_table = 'hr_rating_guidelines'
        verbose_name = 'Rating Guideline'
        verbose_name_plural = 'Rating Guidelines'
```

--- END OF SECTION 4 ---

## 5. FOREIGN KEY RELATIONSHIPS

### 5.1 Primary Relationships
- **RatingScale** → **Company**: Company ownership
- **RatingLevel** → **RatingScale**: Levels within scale
- **CalibrationSession** → **ReviewCycle**: Session for cycle
- **CalibrationSession** → **RatingScale**: Scale being calibrated

### 5.2 Many-to-Many Relationships
- **RatingScale** ↔ **RatingLevel**: One-to-many relationship
- **CalibrationSession** ↔ **RatingDistribution**: One-to-many relationship

--- END OF SECTION 5 ---

## 6. BUSINESS RULES & VALIDATIONS

### 6.1 Data Integrity Rules
- Rating scale codes must be unique within company
- Rating levels must be sequential within scale
- Numeric values must be within scale range
- Calibration sessions must have valid dates
- Rating distributions must sum to 100%

### 6.2 Validation Logic
```python
def clean_rating_range(self):
    """
    Validate rating scale range
    """
    if self.min_rating >= self.max_rating:
        raise ValidationError("Maximum rating must be greater than minimum rating")

def clean_level_sequence(self):
    """
    Validate rating level sequence
    """
    if self.level_number and self.level_number < 1:
        raise ValidationError("Level number must be positive")

def clean_numeric_value(self):
    """
    Validate numeric rating value
    """
    if self.numeric_value and (self.numeric_value < 0 or self.numeric_value > 10):
        raise ValidationError("Numeric rating must be between 0 and 10")
```

### 6.3 Business Constraints
- Maximum rating levels per scale: 10
- Maximum calibration session duration: 8 hours
- Minimum calibration participants: 3
- Rating distribution tolerance: ±10%

--- END OF SECTION 6 ---

## 7. UI/UX SPECIFICATIONS

### 7.1 User Interface Requirements
- **Layout:** Dashboard with rating scale overview and calibration tracking
- **Navigation:** Tabbed interface for different rating components
- **Responsiveness:** Mobile-optimized for rating access
- **Views:** HR view, Manager view, Leadership view

### 7.2 User Experience Design
- **User Flow:** Define scale → Create levels → Calibrate ratings → Monitor distribution
- **Error Handling:** Clear validation messages and error recovery
- **Visual Analytics:** Rating distribution charts and calibration insights
- **Quick Actions:** One-click rating application and calibration

### 7.3 Accessibility Standards
- **WCAG Compliance:** WCAG 2.1 AA
- **Keyboard Navigation:** Full keyboard accessibility
- **Screen Reader Support:** Proper ARIA labels and semantic HTML

### 7.4 Visual Design System
- **Color Scheme:** Consistent color coding for rating levels
- **Typography:** Clear, readable fonts for rating descriptions
- **Iconography:** Intuitive icons for rating actions and statuses

--- END OF SECTION 7 ---

## 8. INTEGRATION POINTS

### 8.1 External Systems
- **Analytics Platforms:** Rating analytics and reporting
- **Communication Platforms:** Calibration session notifications
- **Document Storage**: Rating guideline and documentation management
- **Video Conferencing**: Virtual calibration session support
- **Compliance Systems**: Rating fairness and audit compliance

### 8.2 Internal APIs
- **Performance Review API:** Rating integration with reviews
- **Employee Management API:** Employee and manager information
- **Goal Setting API:** Goal-based rating integration
- **Notification API:** Rating notifications and alerts
- **Reporting API:** Rating analytics and metrics

--- END OF SECTION 8 ---

## 9. API SPECIFICATIONS

### 9.1 REST Endpoints

#### **GET /api/rating-scales/**
- **Purpose:** Retrieve rating scales list
- **Authentication:** JWT token required
- **Parameters**: 
  - `status` (string): Filter by status
  - `scale_type` (string): Filter by type
- **Response:** Paginated list of rating scales

#### **POST /api/rating-scales/**
- **Purpose:** Create new rating scale
- **Authentication:** JWT token required
- **Request Body:** Rating scale configuration
- **Response:** Created rating scale object

#### **GET /api/rating-scales/{scale_id}/**
- **Purpose:** Retrieve specific rating scale details
- **Authentication:** JWT token required
- **Parameters:** `scale_id` (UUID)
- **Response:** Complete rating scale with levels

#### **PUT /api/rating-scales/{scale_id}/**
- **Purpose:** Update rating scale
- **Authentication:** JWT token with appropriate permissions
- **Request Body:** Updated rating scale data
- **Response:** Updated rating scale object

#### **POST /api/rating-scales/{scale_id}/levels/**
- **Purpose:** Add rating level to scale
- **Authentication:** JWT token required
- **Request Body:** Rating level configuration
- **Response:** Created rating level object

#### **GET /api/rating-scales/{scale_id}/levels/**
- **Purpose:** Retrieve rating scale levels
- **Authentication:** JWT token required
- **Response:** List of rating levels

#### **GET /api/calibration-sessions/**
- **Purpose:** Retrieve calibration sessions list
- **Authentication:** JWT token required
- **Parameters**: 
  - `review_cycle_id` (UUID): Filter by cycle
  - `status` (string): Filter by status
- **Response:** Paginated list of calibration sessions

#### **POST /api/calibration-sessions/**
- **Purpose:** Create new calibration session
- **Authentication:** JWT token required
- **Request Body:** Calibration session configuration
- **Response:** Created calibration session object

#### **POST /api/calibration-sessions/{session_id}/start/**
- **Purpose:** Start calibration session
- **Authentication:** JWT token required
- **Response:** Updated calibration session status

#### **GET /api/rating-distributions/**
- **Purpose:** Retrieve rating distribution analysis
- **Authentication:** JWT token required
- **Parameters**: 
  - `review_cycle_id` (UUID): Filter by cycle
  - `rating_scale_id` (UUID): Filter by scale
- **Response:** Rating distribution data

#### **GET /api/rating-scales/default/**
- **Purpose:** Retrieve default rating scale
- **Authentication:** JWT token required
- **Response:** Default rating scale object

### 9.2 Data Formats
- **Request Format:** JSON
- **Response Format:** JSON
- **Error Format:** Standardized error response with validation details

--- END OF SECTION 9 ---

## 10. SECURITY REQUIREMENTS

### 10.1 Authentication
- **Method:** JWT-based authentication with role-based access
- **Authorization:** Rating access based on user role and permissions
- **Session Management:** Secure session handling with timeout

### 10.2 Data Protection
- **Encryption:** Encrypted storage for sensitive rating data
- **Privacy Controls:** Rating data privacy and access restrictions
- **Data Masking**: Sensitive information masking for unauthorized viewers

### 10.3 Access Control
- **Permissions:**
  - **HR Admin:** Full access to all rating scales and calibration
  - **Manager:** Access to applicable rating scales and calibration participation
  - **Leadership:** View access to rating analytics and distributions
  - **Employee:** Read-only access to rating guidelines
- **Audit Trail:** Complete audit logging for all rating changes

--- END OF SECTION 10 ---

## 11. PERFORMANCE CONSIDERATIONS

### 11.1 Database Optimization
- **Indexing Strategy:** Optimized indexes on scale IDs and status
- **Query Optimization:** Efficient rating data retrieval with proper joins
- **Connection Pooling:** Database connection management for high-volume access

### 11.2 Caching Strategy
- **Cache Layers:** Redis for frequently accessed rating data
- **Cache Invalidation:** Smart cache invalidation on rating updates
- **Performance Metrics:** Sub-300ms response time for rating operations

--- END OF SECTION 11 ---

## 12. TESTING REQUIREMENTS

### 12.1 Unit Tests
- **Coverage Target:** 85%
- **Test Framework:** pytest with Django test extensions
- **Test Data:** Factory Boy for comprehensive test data generation

### 12.2 Integration Tests
- **API Testing:** Complete API endpoint testing
- **Rating Calculation Testing:** Rating calculation accuracy
- **Calibration Testing**: Calibration process validation

### 12.3 User Acceptance Tests
- **UAT Scenarios:** Complete rating management workflows
- **Cross-browser Testing:** Compatibility across major browsers
- **Mobile Testing:** Responsive design validation

--- END OF SECTION 12 ---

## 13. DEPLOYMENT SPECIFICATIONS

### 13.1 Environment Requirements
- **Development:** Local development with mock data
- **Staging:** Full integration testing with external systems
- **Production:** Scalable cloud infrastructure with secure integrations

### 13.2 Configuration Management
- **Settings:** Environment-specific configuration
- **API Keys:** Secure management of external service credentials
- **Security Settings:** Production security hardening

--- END OF SECTION 13 ---

## 14. MAINTENANCE & SUPPORT

### 14.1 Regular Maintenance
- **Data Cleanup:** Regular archiving of historical rating data
- **Performance Monitoring:** Rating system performance tracking
- **Security Updates:** Regular security patching

### 14.2 Support Procedures
- **User Support:** Help desk integration for rating issues
- **Documentation:** Comprehensive user guides and API documentation
- **Training:** Regular training sessions for HR and managers

--- END OF SECTION 14 ---

## 15. VERSION CONTROL

### 15.1 Version History
- **v1.0.0:** Initial release with basic rating functionality
- **v1.1.0:** Enhanced calibration and analytics features
- **v1.2.0:** Advanced rating distribution monitoring

### 15.2 Change Management
- **Release Process:** Structured release with rollback capability
- **Migration Scripts:** Database migration handling
- **Feature Flags:** Gradual feature rollout capability

--- END OF SECTION 15 ---

## 16. COMPLIANCE & AUDIT

### 16.1 Regulatory Compliance
- **Data Privacy:** Rating data privacy and access compliance
- **Accessibility:** ADA compliance for rating systems
- **Audit Requirements**: Complete audit trail maintenance
- **Performance Standards**: Industry best practices compliance

### 16.2 Audit Requirements
- **Audit Trail:** Complete change history logging for all rating changes
- **Rating Reports:** Automated generation of required reports
- **Access Logging**: Comprehensive access audit logging
- **Compliance Reports**: Automated compliance reporting and validation

--- END OF SECTION 16 ---

**END OF BBP TEMPLATE**
