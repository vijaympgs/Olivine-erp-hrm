# 1. MODULE IDENTIFICATION

**Module Name:** Review Cycle
**Module Number:** 06.2
**Module Type:** Transaction
**Target File:** HR/06.Performance & Goals/06.2 Review Cycle.md
**Created Date:** December 29, 2025
**Version:** 1.0
**Author:** HR System Architect

--- END OF SECTION 1 ---

## 2. PURPOSE

### 2.1 Business Purpose
The Review Cycle module provides a comprehensive system for managing structured performance review processes. It enables organizations to conduct regular performance evaluations, facilitate meaningful feedback exchanges, track review completion, and ensure consistent performance management practices across the organization while supporting various review types and frequencies.

### 2.2 Business Scope
**In Scope:**
- Performance review cycle creation and management
- Multiple review types (annual, semi-annual, quarterly, project-based)
- Self-assessment and manager evaluation workflows
- 360-degree feedback and peer reviews
- Goal-based performance evaluation
- Competency and behavior assessment
- Review scheduling and deadline management
- Review form templates and customization
- Review status tracking and reporting
- Calibration and moderation processes
- Review history and trend analysis
- Mobile review access and completion
- Review analytics and insights
- Integration with goal setting and compensation
- Automated reminders and notifications

**Out of Scope:**
- Goal creation and tracking (handled in Goal Setting module)
- Rating scale definition (handled in Ratings module)
- Compensation planning and bonus calculations
- Advanced talent analytics and succession planning

### 2.3 Key Stakeholders
- **Employees:** Self-assessment and review participation
- **Managers:** Employee evaluation and feedback delivery
- **HR Department:** Review cycle administration and oversight
- **Leadership:** Review process monitoring and decision making
- **Peers:** 360-degree feedback contribution
- **Calibration Committees:** Rating calibration and moderation

--- END OF SECTION 2 ---

## 3. CORE MODELS (DJANGO)

### 3.1 Primary Model: ReviewCycle

```python
class ReviewCycle(models.Model):
    """
    Main review cycle model for performance management
    """
    
    # Primary Key
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    
    # Foreign Keys
    company_id = models.UUIDField()
    created_by_user_id = models.UUIDField()
    updated_by_user_id = models.UUIDField()
    
    # Cycle Details
    cycle_name = models.CharField(max_length=200)
    cycle_code = models.CharField(max_length=50)
    cycle_type = models.CharField(max_length=50, choices=[
        ('annual', 'Annual Review'),
        ('semi_annual', 'Semi-Annual Review'),
        ('quarterly', 'Quarterly Review'),
        ('monthly', 'Monthly Review'),
        ('project', 'Project-Based Review'),
        ('probation', 'Probation Review'),
        ('promotion', 'Promotion Review'),
        ('custom', 'Custom Review'),
    ])
    
    # Timeline Management
    start_date = models.DateField()
    end_date = models.DateField()
    self_assessment_start = models.DateField()
    self_assessment_end = models.DateField()
    manager_review_start = models.DateField()
    manager_review_end = models.DateField()
    
    # Status Management
    status = models.CharField(max_length=20, choices=[
        ('draft', 'Draft'),
        ('planned', 'Planned'),
        ('active', 'Active'),
        ('self_assessment', 'Self Assessment'),
        ('manager_review', 'Manager Review'),
        ('calibration', 'Calibration'),
        ('completed', 'Completed'),
        ('cancelled', 'Cancelled'),
    ], default='draft')
    
    # Configuration
    include_self_assessment = models.BooleanField(default=True)
    include_manager_review = models.BooleanField(default=True)
    include_peer_review = models.BooleanField(default=False)
    include_360_feedback = models.BooleanField(default=False)
    include_goal_evaluation = models.BooleanField(default=True)
    include_competency_assessment = models.BooleanField(default=True)
    
    # Review Settings
    require_goal_completion = models.BooleanField(default=True)
    require_manager_approval = models.BooleanField(default=True)
    allow_employee_comments = models.BooleanField(default=True)
    allow_manager_editing = models.BooleanField(default=True)
    
    # Scope and Applicability
    applies_to_all = models.BooleanField(default=True)
    applies_to_departments = models.JSONField(default=list, blank=True)
    applies_to_employees = models.JSONField(default=list, blank=True)
    applies_to_employee_types = models.JSONField(default=list, blank=True)
    excludes_employees = models.JSONField(default=list, blank=True)
    
    # Notifications
    enable_notifications = models.BooleanField(default=True)
    notification_schedule = models.JSONField(default=dict, blank=True)
    reminder_enabled = models.BooleanField(default=True)
    reminder_frequency_days = models.IntegerField(default=7)
    
    # Description and Guidelines
    description = models.TextField(blank=True)
    employee_instructions = models.TextField(blank=True)
    manager_instructions = models.TextField(blank=True)
    
    # Audit Fields
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'hr_review_cycles'
        verbose_name = 'Review Cycle'
        verbose_name_plural = 'Review Cycles'
        indexes = [
            models.Index(fields=['company_id', 'status'], name='idx_cycle_status'),
            models.Index(fields=['company_id', 'cycle_type'], name='idx_cycle_type'),
            models.Index(fields=['company_id', 'start_date'], name='idx_cycle_start_date'),
        ]
        constraints = [
            models.UniqueConstraint(fields=['company_id', 'cycle_code'], name='uk_cycle_code'),
        ]
```

### 3.2 Supporting Model: PerformanceReview

```python
class PerformanceReview(models.Model):
    """
    Individual performance review records
    """
    
    # Primary Key
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    
    # Foreign Keys
    company_id = models.UUIDField()
    review_cycle_id = models.UUIDField()
    employee_id = models.UUIDField()
    manager_id = models.UUIDField()
    created_by_user_id = models.UUIDField()
    updated_by_user_id = models.UUIDField()
    
    # Review Details
    review_number = models.CharField(max_length=50)
    review_period_start = models.DateField()
    review_period_end = models.DateField()
    
    # Status Management
    status = models.CharField(max_length=20, choices=[
        ('not_started', 'Not Started'),
        ('self_assessment', 'Self Assessment'),
        ('manager_review', 'Manager Review'),
        ('peer_review', 'Peer Review'),
        ('calibration', 'Calibration'),
        ('completed', 'Completed'),
        ('on_hold', 'On Hold'),
        ('cancelled', 'Cancelled'),
    ], default='not_started')
    
    # Progress Tracking
    self_assessment_completed = models.BooleanField(default=False)
    self_assessment_date = models.DateTimeField(null=True, blank=True)
    manager_review_completed = models.BooleanField(default=False)
    manager_review_date = models.DateTimeField(null=True, blank=True)
    peer_reviews_completed = models.IntegerField(default=0)
    total_peer_reviews = models.IntegerField(default=0)
    
    # Overall Rating
    overall_rating = models.DecimalField(max_digits=3, decimal_places=2, null=True, blank=True)
    overall_rating_id = models.UUIDField(null=True, blank=True)
    performance_level = models.CharField(max_length=50, blank=True)
    
    # Goal Evaluation Summary
    goals_count = models.IntegerField(default=0)
    goals_achieved = models.IntegerField(default=0)
    goals_partially_achieved = models.IntegerField(default=0)
    goals_not_achieved = models.IntegerField(default=0)
    goal_achievement_percentage = models.IntegerField(default=0)
    
    # Competency Summary
    competencies_count = models.IntegerField(default=0)
    competencies_above_expectations = models.IntegerField(default=0)
    competencies_meets_expectations = models.IntegerField(default=0)
    competencies_below_expectations = models.IntegerField(default=0)
    
    # Development and Feedback
    development_needs = models.JSONField(default=list, blank=True)
    strengths = models.JSONField(default=list, blank=True)
    areas_for_improvement = models.JSONField(default=list, blank=True)
    career_aspirations = models.TextField(blank=True)
    
    # Manager Comments
    manager_summary = models.TextField(blank=True)
    manager_feedback = models.TextField(blank=True)
    manager_recommendations = models.TextField(blank=True)
    
    # Employee Comments
    employee_comments = models.TextField(blank=True)
    employee_feedback = models.TextField(blank=True)
    employee_response = models.TextField(blank=True)
    
    # Sign-off Information
    employee_signoff = models.BooleanField(default=False)
    employee_signoff_date = models.DateTimeField(null=True, blank=True)
    manager_signoff = models.BooleanField(default=False)
    manager_signoff_date = models.DateTimeField(null=True, blank=True)
    
    # Audit Fields
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'hr_performance_reviews'
        verbose_name = 'Performance Review'
        verbose_name_plural = 'Performance Reviews'
        indexes = [
            models.Index(fields=['company_id', 'review_cycle_id'], name='idx_review_cycle'),
            models.Index(fields=['company_id', 'employee_id'], name='idx_review_employee'),
            models.Index(fields=['company_id', 'manager_id'], name='idx_review_manager'),
            models.Index(fields=['company_id', 'status'], name='idx_review_status'),
        ]
        constraints = [
            models.UniqueConstraint(fields=['company_id', 'review_number'], name='uk_review_number'),
        ]
```

### 3.3 Supporting Model: ReviewForm

```python
class ReviewForm(models.Model):
    """
    Review form templates and configurations
    """
    
    # Primary Key
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    
    # Foreign Keys
    company_id = models.UUIDField()
    review_cycle_id = models.UUIDField(null=True, blank=True)
    created_by_user_id = models.UUIDField()
    updated_by_user_id = models.UUIDField()
    
    # Form Details
    form_name = models.CharField(max_length=200)
    form_code = models.CharField(max_length=50)
    form_type = models.CharField(max_length=50, choices=[
        ('self_assessment', 'Self Assessment'),
        ('manager_review', 'Manager Review'),
        ('peer_review', 'Peer Review'),
        ('360_feedback', '360 Degree Feedback'),
        ('calibration', 'Calibration Form'),
    ])
    
    # Form Configuration
    description = models.TextField(blank=True)
    instructions = models.TextField(blank=True)
    
    # Form Structure
    sections = models.JSONField(default=list, blank=True)
    questions = models.JSONField(default=list, blank=True)
    rating_scales = models.JSONField(default=dict, blank=True)
    
    # Form Settings
    is_required = models.BooleanField(default=True)
    allow_partial_save = models.BooleanField(default=True)
    require_comments = models.BooleanField(default=False)
    show_progress = models.BooleanField(default=True)
    
    # Applicability
    applies_to_departments = models.JSONField(default=list, blank=True)
    applies_to_roles = models.JSONField(default=list, blank=True)
    applies_to_levels = models.JSONField(default=list, blank=True)
    
    # Status
    is_active = models.BooleanField(default=True)
    is_template = models.BooleanField(default=False)
    version = models.IntegerField(default=1)
    
    # Audit Fields
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'hr_review_forms'
        verbose_name = 'Review Form'
        verbose_name_plural = 'Review Forms'
        constraints = [
            models.UniqueConstraint(fields=['company_id', 'form_code'], name='uk_form_code'),
        ]
```

--- END OF SECTION 3 ---

## 4. REFERENCE MODELS (DJANGO)

### 4.1 ReviewResponse

```python
class ReviewResponse(models.Model):
    """
    Individual review responses and answers
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_id = models.UUIDField()
    performance_review_id = models.UUIDField()
    review_form_id = models.UUIDField()
    reviewer_id = models.UUIDField()
    
    question_id = models.CharField(max_length=100)
    response_data = models.JSONField(default=dict)
    rating = models.DecimalField(max_digits=3, decimal_places=2, null=True, blank=True)
    comments = models.TextField(blank=True)
    
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'hr_review_responses'
        verbose_name = 'Review Response'
        verbose_name_plural = 'Review Responses'
```

### 4.2 CalibrationSession

```python
class CalibrationSession(models.Model):
    """
    Calibration session for rating moderation
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_id = models.UUIDField()
    review_cycle_id = models.UUIDField()
    session_name = models.CharField(max_length=200)
    session_date = models.DateTimeField()
    
    class Meta:
        db_table = 'hr_calibration_sessions'
        verbose_name = 'Calibration Session'
        verbose_name_plural = 'Calibration Sessions'
```

--- END OF SECTION 4 ---

## 5. FOREIGN KEY RELATIONSHIPS

### 5.1 Primary Relationships
- **ReviewCycle** → **Company**: Company ownership
- **PerformanceReview** → **ReviewCycle**: Review belongs to cycle
- **PerformanceReview** → **Employee**: Employee being reviewed
- **PerformanceReview** → **Manager**: Manager conducting review
- **ReviewForm** → **ReviewCycle**: Form for specific cycle

### 5.2 Many-to-Many Relationships
- **ReviewCycle** ↔ **PerformanceReview**: One-to-many relationship
- **PerformanceReview** ↔ **ReviewResponse**: One-to-many relationship

--- END OF SECTION 5 ---

## 6. BUSINESS RULES & VALIDATIONS

### 6.1 Data Integrity Rules
- Review cycle codes must be unique within company
- Review periods must have valid date ranges
- Review numbers must be unique within company
- Overall ratings must be within valid rating scale
- Review completion must follow proper workflow sequence

### 6.2 Validation Logic
```python
def clean_cycle_dates(self):
    """
    Validate review cycle date logic
    """
    if self.start_date >= self.end_date:
        raise ValidationError("End date must be after start date")
    
    if self.self_assessment_start < self.start_date:
        raise ValidationError("Self assessment start must be after cycle start")

def clean_review_dates(self):
    """
    Validate review period dates
    """
    if self.review_period_start >= self.review_period_end:
        raise ValidationError("Review period end must be after start")

def clean_overall_rating(self):
    """
    Validate overall rating
    """
    if self.overall_rating and (self.overall_rating < 1 or self.overall_rating > 5):
        raise ValidationError("Overall rating must be between 1 and 5")
```

### 6.3 Business Constraints
- Maximum review cycle duration: 365 days
- Minimum review cycle duration: 7 days
- Maximum self-assessment period: 30 days
- Maximum manager review period: 30 days

--- END OF SECTION 6 ---

## 7. UI/UX SPECIFICATIONS

### 7.1 User Interface Requirements
- **Layout:** Dashboard with review cycle overview and progress tracking
- **Navigation:** Tabbed interface for different review types
- **Responsiveness:** Mobile-optimized for review completion
- **Views:** Employee view, Manager view, HR view, Leadership view

### 7.2 User Experience Design
- **User Flow:** Start review → Complete assessment → Submit → Get feedback → Sign-off
- **Error Handling:** Clear validation messages and error recovery
- **Progress Visualization:** Visual progress indicators for review completion
- **Quick Actions:** One-click status updates and notifications

### 7.3 Accessibility Standards
- **WCAG Compliance:** WCAG 2.1 AA
- **Keyboard Navigation:** Full keyboard accessibility
- **Screen Reader Support:** Proper ARIA labels and semantic HTML

### 7.4 Visual Design System
- **Color Scheme:** Status-based color coding for reviews
- **Typography:** Clear, readable fonts for review content
- **Iconography:** Intuitive icons for review actions and statuses

--- END OF SECTION 7 ---

## 8. INTEGRATION POINTS

### 8.1 External Systems
- **Email Systems:** Review notifications and reminders
- **Calendar Systems:** Review deadline scheduling
- **Document Storage**: Review attachment management
- **Analytics Platforms**: Review analytics and reporting
- **Communication Platforms**: Review updates and notifications

### 8.2 Internal APIs
- **Employee Management API:** Employee and manager information
- **Goal Setting API:** Goal integration with reviews
- **Ratings API:** Rating scale and calibration data
- **Notification API:** Review notifications and alerts
- **Reporting API:** Review analytics and metrics

--- END OF SECTION 8 ---

## 9. API SPECIFICATIONS

### 9.1 REST Endpoints

#### **GET /api/review-cycles/**
- **Purpose:** Retrieve review cycles list
- **Authentication:** JWT token required
- **Parameters**: 
  - `status` (string): Filter by status
  - `cycle_type` (string): Filter by type
- **Response:** Paginated list of review cycles

#### **POST /api/review-cycles/**
- **Purpose:** Create new review cycle
- **Authentication:** JWT token required
- **Request Body:** Review cycle configuration
- **Response:** Created review cycle object

#### **GET /api/review-cycles/{cycle_id}/**
- **Purpose:** Retrieve specific review cycle details
- **Authentication:** JWT token required
- **Parameters:** `cycle_id` (UUID)
- **Response:** Complete review cycle with reviews

#### **PUT /api/review-cycles/{cycle_id}/**
- **Purpose:** Update review cycle
- **Authentication:** JWT token with appropriate permissions
- **Request Body:** Updated review cycle data
- **Response:** Updated review cycle object

#### **POST /api/review-cycles/{cycle_id}/activate/**
- **Purpose:** Activate review cycle
- **Authentication:** JWT token required
- **Response:** Updated review cycle status

#### **GET /api/performance-reviews/**
- **Purpose:** Retrieve performance reviews list
- **Authentication:** JWT token required
- **Parameters**: 
  - `employee_id` (UUID): Filter by employee
  - `review_cycle_id` (UUID): Filter by cycle
  - `status` (string): Filter by status
- **Response:** Paginated list of performance reviews

#### **POST /api/performance-reviews/**
- **Purpose:** Create new performance review
- **Authentication:** JWT token required
- **Request Body:** Performance review configuration
- **Response:** Created performance review object

#### **GET /api/performance-reviews/{review_id}/**
- **Purpose:** Retrieve specific performance review details
- **Authentication:** JWT token required
- **Parameters:** `review_id` (UUID)
- **Response:** Complete performance review with responses

#### **PUT /api/performance-reviews/{review_id}/**
- **Purpose:** Update performance review
- **Authentication:** JWT token with appropriate permissions
- **Request Body:** Updated performance review data
- **Response:** Updated performance review object

#### **POST /api/performance-reviews/{review_id}/submit/**
- **Purpose:** Submit performance review
- **Authentication:** JWT token required
- **Request Body:** Submission details
- **Response:** Updated performance review status

#### **GET /api/review-forms/**
- **Purpose:** Retrieve review forms
- **Authentication:** JWT token required
- **Parameters**: `form_type` (string): Filter by type
- **Response:** List of review forms

#### **GET /api/performance-reviews/my-reviews/**
- **Purpose:** Retrieve reviews for current user
- **Authentication:** JWT token required
- **Response:** List of user's reviews

### 9.2 Data Formats
- **Request Format:** JSON
- **Response Format:** JSON
- **Error Format:** Standardized error response with validation details

--- END OF SECTION 9 ---

## 10. SECURITY REQUIREMENTS

### 10.1 Authentication
- **Method:** JWT-based authentication with role-based access
- **Authorization:** Review access based on user role and relationship
- **Session Management:** Secure session handling with timeout

### 10.2 Data Protection
- **Encryption:** Encrypted storage for sensitive review data
- **Privacy Controls:** Review data privacy and access restrictions
- **Data Masking**: Sensitive information masking for unauthorized viewers

### 10.3 Access Control
- **Permissions:**
  - **Employee:** Complete self-assessment and view own reviews
  - **Manager:** Conduct reviews for direct reports
  - **HR Admin:** Full access to all reviews and cycles
  - **Leadership:** View organizational review data
- **Audit Trail:** Complete audit logging for all review changes

--- END OF SECTION 10 ---

## 11. PERFORMANCE CONSIDERATIONS

### 11.1 Database Optimization
- **Indexing Strategy:** Optimized indexes on employee IDs and status
- **Query Optimization:** Efficient review data retrieval with proper joins
- **Connection Pooling:** Database connection management for high-volume access

### 11.2 Caching Strategy
- **Cache Layers:** Redis for frequently accessed review data
- **Cache Invalidation:** Smart cache invalidation on review updates
- **Performance Metrics:** Sub-400ms response time for review operations

--- END OF SECTION 11 ---

## 12. TESTING REQUIREMENTS

### 12.1 Unit Tests
- **Coverage Target:** 85%
- **Test Framework:** pytest with Django test extensions
- **Test Data:** Factory Boy for comprehensive test data generation

### 12.2 Integration Tests
- **API Testing:** Complete API endpoint testing
- **Review Workflow Testing:** Review process validation
- **Notification Testing:** Email and notification validation

### 12.3 User Acceptance Tests
- **UAT Scenarios:** Complete review management workflows
- **Cross-browser Testing:** Compatibility across major browsers
- **Mobile Testing:** Responsive design validation

--- END OF SECTION 12 ---

## 13. DEPLOYMENT SPECIFICATIONS

### 13.1 Environment Requirements
- **Development:** Local development with mock notification services
- **Staging:** Full integration testing with notification systems
- **Production:** Scalable cloud infrastructure with notification integration

### 13.2 Configuration Management
- **Settings:** Environment-specific configuration
- **API Keys:** Secure management of notification service credentials
- **Security Settings:** Production security hardening

--- END OF SECTION 13 ---

## 14. MAINTENANCE & SUPPORT

### 14.1 Regular Maintenance
- **Data Cleanup:** Regular archiving of historical review data
- **Performance Monitoring:** Review system performance tracking
- **Security Updates:** Regular security patching

### 14.2 Support Procedures
- **User Support:** Help desk integration for review issues
- **Documentation:** Comprehensive user guides and API documentation
- **Training:** Regular training sessions for employees and managers

--- END OF SECTION 14 ---

## 15. VERSION CONTROL

### 15.1 Version History
- **v1.0.0:** Initial release with basic review functionality
- **v1.1.0:** Enhanced mobile app and 360-degree feedback
- **v1.2.0:** Advanced calibration and analytics features

### 15.2 Change Management
- **Release Process:** Structured release with rollback capability
- **Migration Scripts:** Database migration handling
- **Feature Flags:** Gradual feature rollout capability

--- END OF SECTION 15 ---

## 16. COMPLIANCE & AUDIT

### 16.1 Regulatory Compliance
- **Data Privacy:** Review data privacy and access compliance
- **Accessibility:** ADA compliance for review systems
- **Audit Requirements**: Complete audit trail maintenance
- **Performance Standards**: Industry best practices compliance

### 16.2 Audit Requirements
- **Audit Trail:** Complete change history logging for all review changes
- **Review Reports:** Automated generation of required reports
- **Access Logging**: Comprehensive access audit logging
- **Compliance Reports**: Automated compliance reporting and validation

--- END OF SECTION 16 ---

**END OF BBP TEMPLATE**
