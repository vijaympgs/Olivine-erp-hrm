# FMS BBP - Withholding Tax

## **1. MODULE IDENTIFICATION**

**Module Name:** Withholding Tax
**Module Number:** 1.6.2
**Module Type:** Master
**Target File:** FMS/01.Finance Setup & Configuration/1.6.Tax Categories/1.6.2 Withholding Tax.md
**Created Date:** December 30, 2025
**Version:** 1.0.0
**Author:** BBP System

--- END OF SECTION 1 ---

## **2. PURPOSE**

### **2.1 Business Purpose**
The Withholding Tax module provides comprehensive configuration and management of tax deduction at source mechanisms, enabling automated calculation, tracking, and compliance of withholding tax obligations across various payment types and jurisdictions for regulatory compliance and financial reporting.

### **2.2 Business Scope**
**In Scope:**
- Withholding tax rate configuration and management
- Tax deduction rules and thresholds setup
- Vendor and customer withholding tax profiles
- Payment type-specific withholding tax rules
- Exemption and threshold management
- Multi-jurisdiction withholding tax compliance
- Tax certificate and documentation tracking
- Integration with payment processing systems

**Out of Scope:**
- Actual payment processing (handled by Payment modules)
- Tax return filing (handled by Tax Returns module)
- Tax payment remittance (handled by Payment modules)
- Financial reporting and analytics (handled by Analytics module)

### **2.3 Key Stakeholders**
- **Tax Managers:** Withholding tax configuration and compliance management
- **Accounts Payable:** Tax deduction processing and vendor management
- **Finance Controllers:** Tax liability tracking and financial oversight
- **Compliance Officers:** Regulatory compliance monitoring and reporting
- **Vendor Management:** Supplier tax profile maintenance

--- END OF SECTION 2 ---

## **3. CORE MODELS (DJANGO)**

### **3.1 Primary Model: WithholdingTaxRate**

```python
class WithholdingTaxRate(models.Model):
    """
    Master withholding tax rate configuration for different payment types and jurisdictions
    """
    
    # Primary Key
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    
    # Foreign Keys
    company_id = models.UUIDField()
    created_by_user_id = models.UUIDField()
    jurisdiction_id = models.UUIDField()
    
    # Core Fields
    tax_code = models.CharField(max_length=20)
    tax_name = models.CharField(max_length=200)
    tax_description = models.TextField(blank=True)
    payment_type = models.CharField(
        max_length=30,
        choices=[
            ('SALARY', 'Salary/Wages'),
            ('CONTRACTOR', 'Contractor Payments'),
            ('RENTAL', 'Rental Income'),
            ('INTEREST', 'Interest Income'),
            ('DIVIDEND', 'Dividend Income'),
            ('ROYALTY', 'Royalty Payments'),
            ('PROFESSIONAL_FEES', 'Professional Fees'),
            ('COMMISSION', 'Commission Payments'),
            ('SUPPLIER_PAYMENTS', 'Supplier Payments'),
            ('OTHER', 'Other Payments'),
        ]
    )
    rate_percentage = models.DecimalField(max_digits=10, decimal_places=4)
    threshold_amount = models.DecimalField(max_digits=20, decimal_places=2, default=0)
    is_compound_tax = models.BooleanField(default=False)
    is_surcharge_applicable = models.BooleanField(default=False)
    surcharge_rate = models.DecimalField(max_digits=10, decimal_places=4, null=True, blank=True)
    cess_rate = models.DecimalField(max_digits=10, decimal_places=4, null=True, blank=True)
    
    # Effective Dates
    effective_date = models.DateField()
    expiry_date = models.DateField(null=True, blank=True)
    is_active = models.BooleanField(default=True)
    
    # Audit Fields
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'fms_withholding_tax_rates'
        verbose_name = 'Withholding Tax Rate'
        verbose_name_plural = 'Withholding Tax Rates'
        indexes = [
            models.Index(fields=['company_id', 'jurisdiction_id', 'payment_type'], name='idx_wtr_company_jur_payment'),
            models.Index(fields=['tax_code'], name='idx_wtr_code'),
            models.Index(fields=['is_active'], name='idx_wtr_active'),
            models.Index(fields=['effective_date'], name='idx_wtr_effective'),
        ]
        constraints = [
            models.UniqueConstraint(
                fields=['company_id', 'jurisdiction_id', 'payment_type', 'tax_code'], 
                name='uk_wtr_company_jur_payment_code'
            ),
        ]

class WithholdingTaxExemption(models.Model):
    """
    Withholding tax exemption rules and certificates
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_id = models.UUIDField()
    withholding_tax_rate_id = models.UUIDField()
    exemption_type = models.CharField(
        max_length=30,
        choices=[
            ('THRESHOLD', 'Threshold Exemption'),
            ('CERTIFICATE', 'Tax Certificate'),
            ('TREATY', 'Tax Treaty'),
            ('SPECIAL', 'Special Exemption'),
            ('GOVERNMENT', 'Government Entity'),
            ('NON_RESIDENT', 'Non-Resident'),
        ]
    )
    exemption_code = models.CharField(max_length=50)
    exemption_description = models.CharField(max_length=500)
    exemption_limit = models.DecimalField(max_digits=20, decimal_places=2, null=True, blank=True)
    certificate_number = models.CharField(max_length=100, blank=True)
    certificate_issue_date = models.DateField(null=True, blank=True)
    certificate_expiry_date = models.DateField(null=True, blank=True)
    issuing_authority = models.CharField(max_length=200, blank=True)
    is_active = models.BooleanField(default=True)
    effective_date = models.DateField()
    expiry_date = models.DateField(null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'fms_withholding_tax_exemptions'
        verbose_name = 'Withholding Tax Exemption'
        verbose_name_plural = 'Withholding Tax Exemptions'
        indexes = [
            models.Index(fields=['company_id', 'withholding_tax_rate_id'], name='idx_wte_company_rate'),
            models.Index(fields=['exemption_code'], name='idx_wte_code'),
            models.Index(fields=['certificate_number'], name='idx_wte_certificate'),
            models.Index(fields=['is_active'], name='idx_wte_active'),
        ]

class WithholdingTaxProfile(models.Model):
    """
    Vendor/customer withholding tax profiles
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_id = models.UUIDField()
    entity_type = models.CharField(
        max_length=20,
        choices=[
            ('VENDOR', 'Vendor/Supplier'),
            ('CUSTOMER', 'Customer'),
            ('CONTRACTOR', 'Contractor'),
            ('EMPLOYEE', 'Employee'),
        ]
    )
    entity_id = models.UUIDField()  # Reference to vendor/customer/employee
    pan_number = models.CharField(max_length=20, blank=True)
    tan_number = models.CharField(max_length=20, blank=True)
    is_tax_deductible = models.BooleanField(default=True)
    default_withholding_tax_rate_id = models.UUIDField(null=True, blank=True)
    exemption_certificate_id = models.UUIDField(null=True, blank=True)
    special_notes = models.TextField(blank=True)
    is_active = models.BooleanField(default=True)
    effective_date = models.DateField()
    expiry_date = models.DateField(null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'fms_withholding_tax_profiles'
        verbose_name = 'Withholding Tax Profile'
        verbose_name_plural = 'Withholding Tax Profiles'
        indexes = [
            models.Index(fields=['company_id', 'entity_type', 'entity_id'], name='idx_wtp_company_entity'),
            models.Index(fields=['pan_number'], name='idx_wtp_pan'),
            models.Index(fields=['tan_number'], name='idx_wtp_tan'),
            models.Index(fields=['is_active'], name='idx_wtp_active'),
        ]
        constraints = [
            models.UniqueConstraint(
                fields=['company_id', 'entity_type', 'entity_id'], 
                name='uk_wtp_company_entity'
            ),
        ]
```

--- END OF SECTION 3 ---

## **4. REFERENCE MODELS (DJANGO)**

### **4.1 Company**

```python
class Company(models.Model):
    """
    Reference to company for multi-tenant support
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_name = models.CharField(max_length=200)
    is_active = models.BooleanField(default=True)
    
    class Meta:
        db_table = 'fms_companies'
        verbose_name = 'Company'
        verbose_name_plural = 'Companies'
```

### **4.2 TaxJurisdiction**

```python
class TaxJurisdiction(models.Model):
    """
    Reference to tax jurisdiction for withholding tax configuration
    """
    
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    company_id = models.UUIDField()
    jurisdiction_code = models.CharField(max_length=10)
    jurisdiction_name = models.CharField(max_length=200)
    country_code = models.CharField(max_length=3)
    is_active = models.BooleanField(default=True)
    
    class Meta:
        db_table = 'fms_tax_jurisdictions'
        verbose_name = 'Tax Jurisdiction'
        verbose_name_plural = 'Tax Jurisdictions'
```

--- END OF SECTION 4 ---

## **5. FOREIGN KEY RELATIONSHIPS**

### **5.1 Primary Relationships**
- **WithholdingTaxRate** → **Company**: Multi-tenant support through company_id
- **WithholdingTaxRate** → **TaxJurisdiction**: Many-to-one relationship for jurisdiction-based rates
- **WithholdingTaxExemption** → **WithholdingTaxRate**: Many-to-one relationship for rate-based exemptions
- **WithholdingTaxProfile** → **Company**: Multi-tenant support through company_id

### **5.2 Many-to-Many Relationships**
- **WithholdingTaxRate** ↔ **Payment Types**: Through payment_type field for multiple payment type support
- **WithholdingTaxProfile** ↔ **Entities**: Through entity_type and entity_id for vendor/customer/employee relationships

--- END OF SECTION 5 ---

## **6. BUSINESS RULES & VALIDATIONS**

### **6.1 Data Integrity Rules**
- Withholding tax codes must be unique within each company and jurisdiction
- Tax rates cannot overlap for the same payment type and jurisdiction
- Exemption certificates must have valid issue and expiry dates
- PAN/TAN numbers must follow Indian tax format validation
- Tax profiles must be unique for each entity within company

### **6.2 Validation Logic**

```python
def clean_tax_code(self):
    """
    Validate withholding tax code format and uniqueness
    """
    if not re.match(r'^[A-Z0-9]{2,20}$', self.tax_code):
        raise ValidationError("Tax code must be 2-20 uppercase alphanumeric characters")
    
    # Check uniqueness within company and jurisdiction
    if WithholdingTaxRate.objects.filter(
        company_id=self.company_id,
        jurisdiction_id=self.jurisdiction_id,
        payment_type=self.payment_type,
        tax_code=self.tax_code
    ).exclude(id=self.id).exists():
        raise ValidationError("Tax code must be unique within company and jurisdiction")

def clean_rate_percentage(self):
    """
    Validate withholding tax rate percentage is within valid range
    """
    if self.rate_percentage < 0 or self.rate_percentage > 100:
        raise ValidationError("Withholding tax rate percentage must be between 0 and 100")

def clean_threshold_amount(self):
    """
    Validate threshold amount is non-negative
    """
    if self.threshold_amount < 0:
        raise ValidationError("Threshold amount must be non-negative")

def clean_surcharge_rate(self):
    """
    Validate surcharge rate when applicable
    """
    if self.is_surcharge_applicable and (self.surcharge_rate is None or self.surcharge_rate < 0):
        raise ValidationError("Surcharge rate must be specified when surcharge is applicable")

def clean_pan_number(self):
    """
    Validate PAN number format for Indian tax compliance
    """
    if self.pan_number and not re.match(r'^[A-Z]{5}[0-9]{4}[A-Z]$', self.pan_number):
        raise ValidationError("PAN number must be in format: ABCDE1234F")

def clean_tan_number(self):
    """
    Validate TAN number format for Indian tax compliance
    """
    if self.tan_number and not re.match(r'^[A-Z]{4}[0-9]{5}[A-Z]$', self.tan_number):
        raise ValidationError("TAN number must be in format: ABCD12345E")

def clean_effective_dates(self):
    """
    Validate effective and expiry dates
    """
    if self.effective_date and self.expiry_date:
        if self.effective_date >= self.expiry_date:
            raise ValidationError("Effective date must be before expiry date")
```

### **6.3 Business Constraints**
- Cannot delete withholding tax rates with active tax profiles
- Cannot modify tax rates if they are used in active payment processing
- Cannot deactivate tax profiles used in current fiscal period
- Exemption certificates must be validated against tax authority databases
- Tax deduction limits must comply with regulatory requirements

--- END OF SECTION 6 ---

## **7. UI/UX SPECIFICATIONS**

### **7.1 User Interface Requirements**
- **Layout:** Master-detail layout with tax rate list and configuration panels
- **Navigation:** Tabbed interface for different withholding tax sections (Rates, Exemptions, Profiles)
- **Responsiveness:** Full desktop experience with tablet support for tax configuration tasks

### **7.2 User Experience Design**
- **User Flow:** Browse tax rates → Select rate → Configure exemptions → Set profiles → Test calculations → Save
- **Error Handling:** Inline validation with clear error messages for tax configuration conflicts
- **Loading States:** Progress indicators for tax calculation testing and validation

### **7.3 Accessibility Standards**
- **WCAG Compliance:** WCAG 2.1 AA compliance
- **Keyboard Navigation:** Full keyboard accessibility for all tax configuration controls
- **Screen Reader Support:** Comprehensive ARIA labels for complex tax form relationships

### **7.4 Visual Design System**
- **Design System:** Material Design 3.0
- **Component Library:** Material-UI (MUI) v5
- **Design Tokens:** Custom design token system

### **7.5 Typography Standards**
- **Primary Font Family:** 'Inter', 'Roboto', sans-serif
- **Secondary Font Family:** 'JetBrains Mono', monospace
- **Font Sizes:**
  - **H1:** 32px / 700 / 40px
  - **H2:** 24px / 600 / 32px
  - **H3:** 20px / 600 / 28px
  - **H4:** 18px / 600 / 24px
  - **H5:** 16px / 600 / 24px
  - **H6:** 14px / 600 / 20px
  - **Body Large:** 16px / 400 / 24px
  - **Body Medium:** 14px / 400 / 20px
  - **Body Small:** 12px / 400 / 16px
  - **Caption:** 11px / 400 / 16px

### **7.6 Color Palette**
- **Primary Colors:**
  - **Primary 50:** #e3f2fd
  - **Primary 100:** #bbdefb
  - **Primary 200:** #90caf9
  - **Primary 300:** #64b5f6
  - **Primary 400:** #42a5f5
  - **Primary 500:** #2196f3
  - **Primary 600:** #1e88e5
  - **Primary 700:** #1976d2
  - **Primary 800:** #1565c0
  - **Primary 900:** #0d47a1
- **Semantic Colors:**
  - **Success:** #4caf50
  - **Warning:** #ff9800
  - **Error:** #f44336
  - **Info:** #2196f3

### **7.7 Spacing System**
- **Base Unit:** 4px
- **Spacing Scale:**
  - **XS:** 4px
  - **SM:** 8px
  - **MD:** 16px
  - **LG:** 24px
  - **XL:** 32px
  - **2XL:** 48px
  - **3XL:** 64px

### **7.8 Component Standards**
- **Buttons:**
  - **Primary Button:** Height 40px, Padding 0 24px, Border-radius 8px
  - **Secondary Button:** Height 40px, Padding 0 16px, Border-radius 8px
- **Form Controls:**
  - **Text Input:** Height 56px, Padding 16px, Border-radius 8px
  - **Select Dropdown:** Height 56px, Padding 16px, Border-radius 8px

### **7.9 Filter System Standards**
- **Filter Layout:** Sidebar filter panel
- **Filter Components:** Search, payment type filter, jurisdiction filter, status filter
- **Filter Actions:** Apply, Clear, Reset buttons

### **7.10 Data Display Standards**
- **Tables:**
  - **Header Row:** Height 56px, background #f8f9fa
  - **Data Row:** Height 48px, hover background #f5f5f5
  - **Cell Padding:** 16px horizontal, 12px vertical

--- END OF SECTION 7 ---

## **8. INTEGRATION POINTS**

## **8.1 External Systems**
- **Tax Authority APIs:** Integration with income tax department for certificate validation
- **PAN Verification APIs:** Real-time PAN number validation and verification
- **Bank APIs:** Integration with banking systems for payment processing
- **Compliance Services:** External tax compliance monitoring and reporting services

## **8.2 Internal APIs**
- **Payment Processing API:** Withholding tax calculation integration for payment processing
- **Vendor Management API:** Vendor tax profile synchronization and management
- **User Management API:** Role-based access control for tax configuration
- **Audit Trail API:** Complete audit logging for all withholding tax operations

--- END OF SECTION 8 ---

## **9. API SPECIFICATIONS**

## **9.1 REST Endpoints**

#### **GET /api/withholding-tax-rates/**
- **Purpose:** Retrieve all withholding tax rates for a company
- **Authentication:** JWT token required
- **Parameters:** company_id, jurisdiction_id, payment_type, is_active
- **Response:** List of withholding tax rate objects with applicability details

#### **POST /api/withholding-tax-rates/**
- **Purpose:** Create new withholding tax rate
- **Authentication:** JWT token required
- **Request Body:** Withholding tax rate configuration with validation rules
- **Response:** Created withholding tax rate object with validation results

#### **PUT /api/withholding-tax-rates/{id}/**
- **Purpose:** Update existing withholding tax rate
- **Authentication:** JWT token required
- **Request Body:** Updated withholding tax rate configuration
- **Response:** Updated withholding tax rate object with change tracking

#### **GET /api/withholding-tax-exemptions/**
- **Purpose:** Retrieve withholding tax exemptions
- **Authentication:** JWT token required
- **Parameters:** company_id, withholding_tax_rate_id, exemption_type, is_active
- **Response:** List of withholding tax exemption objects with certificate details

#### **POST /api/withholding-tax-exemptions/**
- **Purpose:** Create new withholding tax exemption
- **Authentication:** JWT token required
- **Request Body:** Withholding tax exemption configuration with certificate details
- **Response:** Created withholding tax exemption object with validation results

#### **GET /api/withholding-tax-profiles/**
- **Purpose:** Retrieve withholding tax profiles
- **Authentication:** JWT token required
- **Parameters:** company_id, entity_type, entity_id, is_active
- **Response:** List of withholding tax profile objects with entity details

#### **POST /api/withholding-tax-profiles/**
- **Purpose:** Create new withholding tax profile
- **Authentication:** JWT token required
- **Request Body:** Withholding tax profile configuration with entity reference
- **Response:** Created withholding tax profile object with validation results

#### **POST /api/withholding-tax-calculate/**
- **Purpose:** Calculate withholding tax for payment
- **Authentication:** JWT token required
- **Request Body:** Payment amount, payment type, entity profile, date
- **Response:** Withholding tax calculation results with applied rates and exemptions

## **9.2 Data Formats**
- **Request Format:** JSON with proper withholding tax rate and profile validation
- **Response Format:** JSON with standardized withholding tax calculation data
- **Error Format:** JSON with withholding tax-specific error details and validation messages

--- END OF SECTION 9 ---

## **10. SECURITY REQUIREMENTS**

## **10.1 Authentication**
- **Method:** JWT-based authentication with role-based access control
- **Authorization:** Withholding tax permissions (view, create, edit, delete, admin)
- **Session Management:** Secure session handling with automatic timeout

## **10.2 Data Protection**
- **Encryption:** AES-256 encryption for sensitive tax data
- **Data Masking:** Partial masking of PAN/TAN numbers in logs
- **Audit Trail:** Complete audit logging for all withholding tax operations

## **10.3 Access Control**
- **Permissions:**
  - withholding_tax_view: View withholding tax configurations
  - withholding_tax_create: Create new withholding tax rates
  - withholding_tax_edit: Modify existing withholding tax rates
  - withholding_tax_delete: Deactivate withholding tax rates
  - withholding_tax_admin: Full administrative access
- **Roles:** Tax Manager, Accounts Payable, Finance Controller, Compliance Officer
- **Audit Trail:** Complete audit logging for all withholding tax operations

--- END OF OF SECTION 10 ---

## **11. PERFORMANCE CONSIDERATIONS**

## **11.1 Database Optimization**
- **Indexing Strategy:** Optimized indexes for withholding tax rate and profile queries
- **Query Optimization:** Efficient queries for tax calculation and rate lookups
- **Connection Pooling:** Database connection management for concurrent tax calculations

## **11.2 Caching Strategy**
- **Cache Layers:** Redis caching for frequently accessed withholding tax rates and profiles
- **Cache Invalidation:** Time-based and event-driven cache invalidation for tax updates
- **Performance Metrics:** Withholding tax calculation performance and accuracy rates

--- END OF SECTION 11 ---

## **12. TESTING REQUIREMENTS**

## **12.1 Unit Tests**
- **Coverage Target:** 95% code coverage for withholding tax models and business logic
- **Test Framework:** pytest with Django test framework
- **Test Data:** Comprehensive test data for various withholding tax scenarios and payment types

## **12.2 Integration Tests**
- **API Testing:** Complete API endpoint testing for withholding tax operations
- **Tax Calculation Testing:** Withholding tax rule accuracy and performance validation
- **Profile Testing:** Entity profile validation and tax calculation accuracy

## **12.3 User Acceptance Tests**
- **UAT Scenarios:** End-to-end withholding tax configuration workflows
- **User Stories:** Rate setup, exemption configuration, profile management, calculation validation
- **Acceptance Criteria:** Accurate withholding tax calculation with proper exemption handling

--- END OF SECTION 12 ---

## **13. DEPLOYMENT SPECIFICATIONS**

## **13.1 Environment Requirements**
- **Development:** Local development with sample withholding tax configurations
- **Staging:** Pre-production environment with full tax calculation testing
- **Production:** High-availability setup with scalable withholding tax calculation capabilities

## **13.2 Configuration Management**
- **Settings:** Withholding tax configuration parameters and calculation rules
- **Environment Variables:** API keys for tax authority and PAN verification services
- **Secrets Management:** Secure storage of sensitive withholding tax configuration data

## **13.3 Monitoring & Logging**
- **Application Logs:** Withholding tax operation logs with detailed audit trails
- **Performance Metrics:** Withholding tax calculation performance and accuracy rates
- **Error Tracking:** Real-time error monitoring and alerting

--- END OF SECTION 13 ---

## **14. MAINTENANCE & SUPPORT**

## **14.1 Regular Maintenance**
- **Database Maintenance:** Monthly withholding tax rate updates and archiving
- **Performance Tuning:** Quarterly performance optimization for tax calculations
- **Compliance Updates:** Regular updates to withholding tax rules and regulatory requirements

## **14.2 Support Procedures**
- **Issue Tracking:** Ticket system integration for withholding tax configuration issues
- **Knowledge Base:** Documentation for withholding tax configuration procedures
- **User Training:** Training programs for tax managers and accounts payable staff

--- END OF SECTION 14 ---

## **15. VERSION CONTROL**

## **15.1 Version History**
- **v1.0.0:** Initial release with basic withholding tax rate management
- **v1.1.0:** Added advanced exemption rules and certificate management
- **v1.2.0:** Enhanced multi-jurisdiction withholding tax calculation capabilities

## **15.2 Change Management**
- **Release Process:** Structured release process with backward compatibility
- **Rollback Procedures:** Emergency rollback capabilities for critical withholding tax issues
- **Migration Scripts:** Data migration scripts for withholding tax schema updates

--- END OF SECTION 15 ---

## **16. COMPLIANCE & AUDIT**

## **16.1 Regulatory Compliance**
- **Income Tax Act:** Compliance with Indian Income Tax Act and withholding tax provisions
- **GST Regulations:** Compliance with GST withholding tax rules and procedures
- **Data Protection:** GDPR and data protection compliance for withholding tax data
- **Audit Requirements:** Professional audit standards for withholding tax configuration management

## **16.2 Audit Requirements**
- **Audit Trail:** Complete audit trail for all withholding tax configuration operations and changes
- **Tax Reports:** Automated generation of withholding tax compliance reports
- **Change Documentation:** Comprehensive documentation of all withholding tax configuration changes
- **Security Controls:** Proper segregation of duties and access controls for withholding tax data

--- END OF SECTION 16 ---

**END OF WITHHOLDING TAX BBP**
