# 5.5.2 Stock Take Execution
Template Ref: _txn_02 (Medium Transaction)

## 5.5.2.1 Business Purpose

The **Stock Take Execution** module is used to perform physical inventory counts and reconcile them with system records. It provides the mechanism for identifying stock variances, shrinkage, and administrative errors.

**Goals**:
-   **Verification**: Confirm physical quantity matches system recorded balance.
-   **Documentation**: Provide a snapshot of system stock before counting starts.
-   **Workflow**: Manage the lifecycle of a count from Snapshot → Counting → Variance Review → Approval → Posting.

---

## 5.5.2.2 Data Model

### A) Stock Take Header (`stock_take`)

| Field | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| `id` | UUID | Yes | Primary Key |
| `company_id` | FK (Company) | Yes | |
| `stock_take_number` | String(30) | Yes | ID (e.g., ST-2025-001) |
| `location_id` | FK (Location) | Yes | Where the count happens |
| `status` | Enum | Yes | `DRAFT`, `SNAPSHOT_TAKEN`, `IN_PROGRESS`, `REVIEW_PENDING`, `COMPLETED` |
| `snapshot_time` | DateTime | No | When system qty was captured |
| `remarks` | Text | No | |

### B) Stock Take Line (`stock_take_line`)

| Field | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| `id` | UUID | Yes | Primary Key |
| `stock_take_id` | FK (Header) | Yes | |
| `item_variant_id` | FK (ItemVariant) | Yes | |
| `system_qty` | Decimal | Yes | Qty captured at snapshot |
| `physical_qty` | Decimal | No | User-entered count |
| `variance` | Decimal | No | `physical_qty - system_qty` |
| `is_recounted` | Boolean | Yes | |

---

## 5.5.2.3 Module Metadata & Build Steps

```yaml
module_type: transaction
complexity: medium
template_ref: _txn_02

depends_on:
  - Inventory balance
  - Location
  - Item Variant

notes: >
  Snapshot is critical. System qty must be locked 
  the moment 'Start Count' is clicked.
```
