# 1.1 Employee Management – BBP ADDENDUM (Missing Sections)

**Date**: 2025-12-28 21:15 IST  
**Purpose**: Add 4 missing sections to achieve 100% BBP alignment  
**Status**: Supplementary to main BBP

---

**NOTE**: This document contains the 4 missing sections that should be inserted into the main BBP file `1.1 Employee Management.md` after section 1.1.13 and before section 1.1.X.

The missing sections are:
1. **1.2 Employee Master** - UI/UX Requirements
2. **1.3 Validation Rules** - Complete validation specifications
3. **1.4 Employee Lifecycle Workflow** - State machine and transitions
4. **1.5 Module Metadata & Build Steps** - Implementation guidance

---

## 1.2 Employee Master

### 1.2.1 Business Purpose

The Employee Master provides comprehensive employee data management capabilities for HR administrators. It serves as the central interface for creating, updating, and managing complete employee records with full access to all employee information including sensitive data (salary, performance, compliance).

### 1.2.2 Business Scope

Enable HR administrators to:
- Create and maintain complete employee records
- Manage employee lifecycle from hire to retire
- Update employment details, compensation, and compliance information
- Perform bulk operations (import, export, updates)
- Track audit history and changes
- Manage employee documents and attachments

### 1.2.3 UI/UX Requirements

**Screen Name:** Employee Master  
**Path:** Human Resources → Employee Management → Employee Master

#### A) Employee List View

**Columns:**
- Employee Photo/Avatar
- Employee Code
- Employee Name (Display Name)
- Department
- Position
- Employment Status (with color-coded badge)
- Employment Type
- Date of Joining
- Manager
- Primary Location
- Actions (Edit, Delete)

**Filters:**
- Search (name, email, employee code)
- Department (multi-select)
- Position (multi-select)
- Employment Status (multi-select)
- Employment Type (multi-select)
- Location (multi-select)
- Manager (lookup)
- Date Range (hire date, exit date)
- Active/Inactive toggle

**Actions:**
- Create Employee (button)
- Bulk Import (CSV/Excel upload)
- Export (CSV/Excel download)
- Advanced Search (modal)
- Refresh
- Column Customization

**Sorting:**
- Employee Code (default)
- Name (A-Z, Z-A)
- Department
- Date of Joining
- Employment Status

---

#### B) Employee Form (Create/Edit)

**Form Sections:**

**Section 1: Personal Information**
- Title (Mr, Mrs, Ms, Dr, Prof)
- First Name * (required)
- Middle Name
- Last Name * (required)
- Display Name (auto-generated, editable)
- Preferred Name
- Gender (Male, Female, Other, Prefer not to say)
- Date of Birth * (required)
- Place of Birth
- Nationality
- Marital Status (Single, Married, Divorced, Widowed, Separated)
- Blood Group (A+, A-, B+, B-, AB+, AB-, O+, O-)
- Physically Challenged (checkbox)

**Section 2: Contact Information**
- Work Email * (required, unique)
- Personal Email
- Work Phone
- Mobile Phone * (required)
- Emergency Contact Name
- Emergency Contact Phone
- Emergency Contact Relation

**Section 3: Employment Details**
- Employee Code (auto-generated, read-only)
- Employee Number (auto-generated, read-only)
- Company * (required, auto-filled)
- Department * (required, lookup)
- Position * (required, lookup)
- Grade (lookup)
- Manager (employee lookup)
- Primary Location * (required, lookup)
- Employment Type * (required: Permanent, Contract, Intern, Consultant, Temporary)
- Employment Status * (required: Onboarding, Active, On Leave, Suspended, Resigned, Terminated, Retired)
- Employment Category (Staff, Worker, Executive, Management)
- Hire Date * (required)
- Confirmation Date
- Probation End Date
- Exit Date
- Exit Reason
- Exit Type (Resignation, Termination, Retirement, Contract End, Death)

**Section 4: Address Information**
- Work Address (address lookup/form)
- Home Address (address lookup/form)

**Section 5: Banking Information** (Encrypted)
- Bank Account Number
- Bank Name
- Bank Branch
- Bank IFSC Code

**Section 6: Compliance & Documents** (Encrypted)
- PAN Number
- Aadhaar Number
- Passport Number
- Passport Expiry Date
- Visa Type
- Visa Expiry Date
- Work Permit Number
- Work Permit Expiry Date
- Social Security Number
- Tax ID

**Section 7: System Information** (Read-Only)
- Created By
- Created At
- Updated By
- Updated At
- Version

**Form Actions:**
- Save as Draft
- Save and Close
- Save and New
- Cancel
- Delete (with confirmation)

---

#### C) Bulk Operations

**Import:**
- Upload CSV/Excel file
- Template download
- Field mapping interface
- Validation preview
- Error report
- Rollback on error

**Export:**
- Select fields to export
- Apply filters
- Choose format (CSV, Excel)
- Include/exclude sensitive data (permission-based)

---

#### D) Employee Profile View (Read-Only)

**Tabs:**
- Overview (summary card)
- Personal Information
- Employment Details
- Documents
- Lifecycle Events
- Audit History
- Related Records (payroll, attendance, performance)

---

### 1.2.4 Access Control

**HR Admin:**
- Full CRUD access
- View all fields including sensitive data
- Bulk operations
- Delete employees
- View audit logs

**Manager:**
- View direct reports (complete information)
- Edit limited fields (contact, emergency info)
- No access to salary, performance, compliance
- No delete access

**Employee:**
- View own record (limited fields)
- Request updates via ESS
- No direct edit access

**System Admin:**
- Technical configuration only
- No access to employee PII data

---

## 1.3 Validation Rules

### 1.3.1 Employee Header Validations

**Required Fields:**
- `first_name` (required, max 100 chars)
- `last_name` (required, max 100 chars)
- `email` (required, unique, valid email format)
- `mobile_number` (required, valid phone format)
- `date_of_birth` (required, must be 18+ years old)
- `company_id` (required)
- `department_id` (required)
- `position_id` (required)
- `primary_location_id` (required)
- `employment_type` (required, enum)
- `employment_status` (required, enum)
- `date_of_joining` (required)

**Unique Constraints:**
- `employee_code` unique per company
- `employee_number` unique per company
- `work_email` globally unique
- `pan_number` unique (if provided)
- `aadhaar_number` unique (if provided)

**Format Validations:**
- Email: Valid email format (RFC 5322)
- Phone: Valid phone format (E.164 or local)
- PAN: AAAAA9999A format (India)
- Aadhaar: 12 digits (India)
- IFSC: AAAA0999999 format (India)
- Passport: Alphanumeric, 6-9 chars

---

### 1.3.2 Personal Information Validations

**Age Validations:**
- Minimum age: 18 years (from date_of_birth)
- Maximum age: 100 years (sanity check)
- Retirement age: Configurable per company (default 60)

**Date Validations:**
- `date_of_birth` must be in the past
- `date_of_birth` must be at least 18 years before today

**Enum Validations:**
- `gender` must be one of: Male, Female, Other, Prefer not to say
- `marital_status` must be one of: Single, Married, Divorced, Widowed, Separated
- `blood_group` must be one of: A+, A-, B+, B-, AB+, AB-, O+, O-

---

### 1.3.3 Employment Validations

**Date Validations:**
- `hire_date` must be in the past or today
- `confirmation_date` must be >= `hire_date` (if provided)
- `probation_end_date` must be >= `hire_date` (if provided)
- `exit_date` must be >= `hire_date` (if provided)
- `passport_expiry_date` must be in the future (if provided)
- `visa_expiry_date` must be in the future (if provided)
- `work_permit_expiry_date` must be in the future (if provided)

**Hierarchy Validations:**
- `manager_id` cannot be self (no circular reporting)
- `manager_id` must be an active employee
- `manager_id` cannot create circular reporting chain (recursive check)
- `department_id` must belong to same company
- `position_id` must belong to same company
- `primary_location_id` must belong to same company

**Status Validations:**
- Cannot change status from `Terminated` to any other status
- Cannot change status from `Resigned` to `Active` without approval
- `exit_date` required if status is `Resigned`, `Terminated`, or `Retired`
- `exit_reason` required if status is `Resigned`, `Terminated`, or `Retired`

---

### 1.3.4 Cross-Field Validations

**Employment Type + Status:**
- `Intern` cannot have status `Retired`
- `Temporary` cannot have `confirmation_date`
- `Contract` must have `exit_date` (contract end date)

**Exit Validations:**
- If `exit_date` is set, `employment_status` must be `Resigned`, `Terminated`, or `Retired`
- If `employment_status` is `Resigned`, `Terminated`, or `Retired`, `exit_date` must be set
- `exit_type` must match `employment_status`:
  - `Resigned` → `exit_type` = `Resignation`
  - `Terminated` → `exit_type` = `Termination`
  - `Retired` → `exit_type` = `Retirement`

**Probation Validations:**
- If `probation_end_date` is set, it must be after `hire_date`
- If `confirmation_date` is set, it must be >= `probation_end_date`
- `Permanent` employees should have `confirmation_date` after probation

**Document Validations:**
- If `passport_number` is provided, `passport_expiry_date` is required
- If `visa_type` is provided, `visa_expiry_date` is required
- If `work_permit_number` is provided, `work_permit_expiry_date` is required

---

### 1.3.5 Status Integrity Rules

**Immutability Rules:**
- `employee_code` is immutable after creation
- `employee_number` is immutable after creation
- `company_id` is immutable after creation
- Terminated employees are immutable (cannot edit any field)

**Soft Delete Rules:**
- Cannot hard delete employees
- Must use soft delete (`deleted_at` timestamp)
- Soft deleted employees:
  - Not shown in active lists
  - Cannot be restored without admin approval
  - Retain all audit history

**Version Control:**
- Optimistic locking using `version` field
- Increment version on every update
- Detect concurrent updates and prevent data loss

---

## 1.4 Employee Lifecycle Workflow

### 1.4.1 Status State Machine

```
Employment Status Flow:

DRAFT
  ↓ (Submit for Onboarding)
ONBOARDING
  ↓ (Complete Onboarding)
ACTIVE
  ↓ (Apply for Leave)        ↓ (Resign)           ↓ (Terminate)        ↓ (Retire)
ON_LEAVE                     RESIGNED             TERMINATED           RETIRED
  ↓ (Return from Leave)
ACTIVE
  ↓ (Suspend)
SUSPENDED
  ↓ (Reactivate)
ACTIVE
```

**Valid Transitions:**

| From Status | To Status | Trigger | Approval Required |
|-------------|-----------|---------|-------------------|
| DRAFT | ONBOARDING | Submit for Onboarding | No |
| ONBOARDING | ACTIVE | Complete Onboarding | Yes (HR) |
| ACTIVE | ON_LEAVE | Apply for Leave | Yes (Manager) |
| ON_LEAVE | ACTIVE | Return from Leave | No |
| ACTIVE | SUSPENDED | Suspend Employee | Yes (HR) |
| SUSPENDED | ACTIVE | Reactivate Employee | Yes (HR) |
| ACTIVE | RESIGNED | Submit Resignation | No |
| RESIGNED | TERMINATED | Convert to Termination | Yes (HR) |
| ACTIVE | TERMINATED | Terminate Employee | Yes (HR + Legal) |
| ACTIVE | RETIRED | Retire Employee | Yes (HR) |

**Invalid Transitions:**
- TERMINATED → Any other status (immutable)
- RETIRED → Any other status (immutable)
- RESIGNED → ACTIVE (must go through re-hire process)

---

### 1.4.2 Transition Rules

**DRAFT → ONBOARDING:**
- Trigger: HR submits employee for onboarding
- Validations:
  - All required fields must be filled
  - No validation errors
- Actions:
  - Generate employee_code and employee_number
  - Send onboarding email to employee
  - Create onboarding tasks
  - Trigger `employee.created` event

**ONBOARDING → ACTIVE:**
- Trigger: Onboarding tasks completed
- Validations:
  - All onboarding tasks completed
  - All documents uploaded
  - Background verification completed (if required)
- Approval: HR Manager
- Actions:
  - Set `confirmation_date` (if applicable)
  - Grant system access
  - Trigger `employee.onboarded` event
  - Trigger `employee.activated` event

**ACTIVE → ON_LEAVE:**
- Trigger: Leave application approved
- Validations:
  - Valid leave application exists
  - Leave balance available
- Approval: Manager
- Actions:
  - Update leave balance
  - Notify team
  - Trigger `employee.on_leave` event

**ON_LEAVE → ACTIVE:**
- Trigger: Leave end date reached or early return
- Validations:
  - Leave period ended
- Actions:
  - Restore system access
  - Notify team
  - Trigger `employee.returned_from_leave` event

**ACTIVE → RESIGNED:**
- Trigger: Employee submits resignation
- Validations:
  - Resignation letter uploaded
  - Notice period specified
- Actions:
  - Set `exit_date` (last working day)
  - Set `exit_type` = 'Resignation'
  - Create exit tasks (knowledge transfer, asset return)
  - Trigger `employee.resigned` event

**ACTIVE → TERMINATED:**
- Trigger: HR terminates employee
- Validations:
  - Termination reason provided
  - Legal approval obtained
- Approval: HR + Legal
- Actions:
  - Set `exit_date` (termination date)
  - Set `exit_type` = 'Termination'
  - Revoke all system access immediately
  - Create exit tasks (asset return, final settlement)
  - Trigger `employee.terminated` event

**ACTIVE → RETIRED:**
- Trigger: Employee reaches retirement age or voluntary retirement
- Validations:
  - Retirement age reached or voluntary retirement approved
  - Retirement benefits calculated
- Approval: HR
- Actions:
  - Set `exit_date` (retirement date)
  - Set `exit_type` = 'Retirement'
  - Create retirement tasks (benefits processing)
  - Trigger `employee.retired` event

---

### 1.4.3 Approval Requirements

**Onboarding Approval:**
- Approver: HR Manager
- Criteria:
  - All onboarding tasks completed
  - All documents verified
  - Background check cleared

**Leave Approval:**
- Approver: Reporting Manager
- Criteria:
  - Leave balance available
  - No conflicting leaves in team
  - Business continuity maintained

**Suspension Approval:**
- Approver: HR Manager + Department Head
- Criteria:
  - Valid reason for suspension
  - Investigation completed (if disciplinary)

**Termination Approval:**
- Approver: HR Manager + Legal + CEO (for senior positions)
- Criteria:
  - Legal clearance obtained
  - Termination reason documented
  - Final settlement calculated

**Retirement Approval:**
- Approver: HR Manager
- Criteria:
  - Retirement age reached or voluntary retirement approved
  - Retirement benefits calculated
  - Handover completed

---

### 1.4.4 Automated Transitions

**Auto-transition to ON_LEAVE:**
- Trigger: Leave start date reached and leave approved
- Frequency: Daily batch job
- Action: Update status to ON_LEAVE

**Auto-transition to ACTIVE:**
- Trigger: Leave end date reached
- Frequency: Daily batch job
- Action: Update status to ACTIVE

**Auto-transition to RETIRED:**
- Trigger: Retirement date reached
- Frequency: Daily batch job
- Action: Update status to RETIRED

**Probation End Reminder:**
- Trigger: 7 days before probation end date
- Action: Send reminder to HR and Manager for confirmation

**Contract End Reminder:**
- Trigger: 30 days before contract end date
- Action: Send reminder to HR for renewal or exit

---

## 1.5 Module Metadata & Build Steps

### Module Metadata

```yaml
module_type: master
complexity: high
template_ref: _master_03

extension_allowed: true

depends_on:
  - Company (business_entities)
  - Locations (company)
  - Departments (hrm)
  - Positions (hrm)
  - Grades (hrm) [optional]
  - Users / Roles (user_management)
  - Address (common)

used_by:
  - Payroll (hrm.payroll)
  - Attendance (hrm.attendance)
  - Performance Management (hrm.performance)
  - Learning & Development (hrm.learning)
  - IAM (user_management)
  - POS Authorization (pos)
  - Approval Workflows (common.workflows)
  - Reporting (reporting)

integrates_with:
  - Email Systems (for notifications)
  - Document Management (for employee documents)
  - Background Verification Services
  - Payroll Systems
  - Attendance Systems
  - Identity Providers (SSO, LDAP, AD)

data_classification: PII - Highly Sensitive
retention_policy: 7 years post-employment + legal requirements
compliance: GDPR, CCPA, SOX, Labor Laws

notes: >
  Employee Management is the authoritative enterprise master for all
  employee-related data. It serves as the single source of truth for
  workforce information and acts as a parent dependency for all HR
  and operational modules. Changes to employee data must be audit-logged
  and downstream systems must integrate via reference or events.
```

---

### Build Steps

**You are building a High Complexity Master module for an Enterprise ERP.**

**Module:** Employee Management  
**Template:** _master_03

---

#### Requirements:

**1) Backend (Django + DRF):**

**Models:**
- `employee` (header with 60+ fields)
- `department` (organizational unit)
- `position` (job title/role)
- `employee_location` (multi-location assignments)
- `employee_document` (document management)
- `employee_lifecycle_event` (lifecycle tracking)

**Serializers:**
- `EmployeeDirectorySerializer` (public fields, read-only)
- `EmployeeMasterListSerializer` (admin list view)
- `EmployeeMasterDetailSerializer` (admin full CRUD)
- `DepartmentSerializer`
- `PositionSerializer`
- `EmployeeLocationSerializer`
- `EmployeeDocumentSerializer`
- `EmployeeLifecycleEventSerializer`

**ViewSets:**
- `EmployeeDirectoryViewSet` (read-only, all users)
  - Filter by: company, department, location, employment_status
  - Search: name, email, employee_code
  - Ordering: name, employee_code, hire_date
- `EmployeeMasterViewSet` (full CRUD, HR Admin only)
  - Filter by: all employee fields
  - Actions/endpoints:
    - `submit_for_onboarding`
    - `activate_employee`
    - `suspend_employee`
    - `terminate_employee`
    - `retire_employee`
    - `bulk_import`
    - `export`
- `DepartmentViewSet`
- `PositionViewSet`
- `EmployeeLocationViewSet`
- `EmployeeDocumentViewSet`
- `EmployeeLifecycleEventViewSet`

**Business Rules:**
- Status transition validations
- Circular reporting prevention
- Terminated employee immutability
- Optimistic locking (version control)
- Auto-generation of employee_code and employee_number
- Audit trail for all changes

---

**2) Frontend (React + Vite + Tailwind):**

**Employee Directory Page:**
- Card grid layout
- Search bar
- Filters (department, location, status)
- Employee cards with:
  - Avatar/photo
  - Name, position, department
  - Contact actions (email, call)
  - Manager information
- Responsive design

**Employee Master Page:**
- Data table with:
  - Columns: code, name, department, position, status, hire date
  - Sorting, filtering, pagination
  - Actions: edit, delete
- Create/Edit form with:
  - Multi-section form (7 sections)
  - Field validations
  - Lookup fields (department, position, manager)
  - Date pickers
  - Encrypted fields (banking, compliance)
- Bulk operations:
  - Import (CSV/Excel)
  - Export (CSV/Excel)
- Status badges (color-coded)
- Approval workflow UI (for status transitions)

---

**3) Integration:**

**Axios Service:**
- All Employee CRUD operations
- Workflow endpoints (submit, activate, suspend, terminate, retire)
- Bulk operations (import, export)
- Search and filter operations

**Event Publishing:**
- `employee.created`
- `employee.onboarded`
- `employee.activated`
- `employee.manager_changed`
- `employee.location_changed`
- `employee.resigned`
- `employee.terminated`
- `employee.retired`

**Event Subscriptions:**
- `leave.approved` → Update status to ON_LEAVE
- `leave.ended` → Update status to ACTIVE
- `user.created` → Link to employee record

---

**4) Security & Permissions:**

**Permission Levels:**
- `hrm.employee.view_directory` (all users)
- `hrm.employee.view_master` (HR Admin)
- `hrm.employee.create` (HR Admin)
- `hrm.employee.edit` (HR Admin)
- `hrm.employee.delete` (HR Admin)
- `hrm.employee.approve_onboarding` (HR Manager)
- `hrm.employee.suspend` (HR Manager)
- `hrm.employee.terminate` (HR Manager + Legal)
- `hrm.employee.view_sensitive` (HR Admin only)

**Data Encryption:**
- Encrypt at rest: banking info, PAN, Aadhaar, passport, SSN
- Encrypt in transit: HTTPS/TLS
- Mask in logs: sensitive fields

**Audit Requirements:**
- Log all CRUD operations
- Log all status transitions
- Log all sensitive field access
- Retain audit logs for 7 years

---

**5) Testing:**

**Unit Tests:**
- Model validations
- Business rule enforcement
- Status transitions
- Circular reporting prevention

**Integration Tests:**
- API endpoints
- Workflow transitions
- Bulk operations
- Event publishing

**UI Tests:**
- Form validations
- Search and filter
- CRUD operations
- Permission enforcement

---

**MODULE:** Employee Management  
**TYPE:** Master (High Complexity, _master_03)

**DATA MODEL:**
- Employee (60+ fields, aggregate root)
- Department, Position, EmployeeLocation, EmployeeDocument, EmployeeLifecycleEvent

**WORKFLOW:**
- DRAFT → ONBOARDING → ACTIVE → ON_LEAVE / SUSPENDED / RESIGNED / TERMINATED / RETIRED

**UI:**
- Employee Directory (public, card-based)
- Employee Master (admin, table + form)

**Use template _master_03 and generate:**
- Django models, serializers, viewsets, URLs
- React pages (Directory + Master)
- Axios API service
- Permission guards
- Event publishers/subscribers

**Enforce all validation and workflow rules described in the Employee Management specification.**

---

**END OF ADDENDUM**

**Integration Instructions**:
These 4 sections (1.2, 1.3, 1.4, 1.5) should be inserted into the main BBP file after section 1.1.13 (KPIs & Monitoring) and before section 1.1.X (Reference Role & Governance Contract).

**Prepared By**: Antigravity  
**Date**: 2025-12-28 21:15 IST  
**Status**: Ready for Integration
